## [2.7.0] - 
- Added parametric P–T retrieval (Guillot 2010) via `PT_profile_type`, sampling k_th/gamma/beta/Tint in MultiNest, generating temperatures with `temp_profile`, and updating parameter labels/ranges.
- For parametric profiles, derive H2O/NH3 cloud vapor ceilings from the retrieved temperature column while limiting manual cloud-top priors to isothermal runs.
- MultiNest post-processing now streams `random_temp_samples.dat`, includes a `plot_PT_profile` diagnostic, and CLI output highlights the active P–T mode.
- Forward radiative-transfer setup now consumes arbitrary temperature arrays, removes the embedded saturation helper, enforces unit surface emissivity, and refines disk integration weights.

## [2.6.6] - 10/23/25
- `plot_posteriors` now honors `corner_selected_params`, trims corner overlays accordingly, and emits `Nest_selected_posteriors.pdf` plus a companion `Nest_1D_posteriors.pdf` for quick 1D diagnostics.
- Corner plotting adds KDE-backed 1D density helper with histogram fallback, saner grid sizing, and per-solution legends so multimodal runs compare cleanly.
- `default_parameters()` exposes a `corner_selected_params` knob (default `None`) so scripted runs can opt into the focused posterior view without manual wiring.
- `ExoReLAlbedoDataset` zero-fills infinite spectral values instead of aborting, keeping training robust when upstream data contains overflow artifacts.

## [2.6.5] - 09/28/25
- Added neural-network forward model support throughout plotting and runtime paths; `FORWARD_AI` now loads inference statistics from `network_config.json` written by the training pipeline, removing the dependency on the original dataset at inference time.
- Training now writes a single consolidated `network_config.json` that includes both configuration metadata and the inference statistics needed by `FORWARD_AI`; resume logic accepts custom checkpoint names and logs the checkpoint being resumed.
- Hardened checkpoint loading against PyTorch 2.6's `weights_only=True` default for both training resumption and AI inference.

## [2.6.4] - 09/19/25
- `TRAIN_NN` now forwards `out_net_name` so checkpoints adopt the name defined in the params file instead of always writing `best.pt`.
- Added checkpoint utilities (`build_checkpoint_path`, `resume_training_state`) to allow `run_training` to resume from saved weights and skip epochs already completed.

## [2.6.3] - 09/18/25
- Debugging network routines.

## [2.6.2] - 09/17/25
- Added transformer-based neural surrogate stack under `network_routines` for albedo prediction, including dataset loader, training loop, inference helpers, and Fourier/LSF utilities tuned for retrieval datasets.
- Wired a `TRAIN_NN` CLI entry point that reads `network_training` parameters from the parfile, links dataset/output locations, and launches training checkpoints/plots via the new pipeline.
- Exposed high-level helpers in `__network.py` to build, train, load, and run the surrogate model programmatically; bumped the package version to `2.6.2` and started tracking the network assets in git.

## [2.6.1] - 09/05/25
- Bugfixes in the generation of the dataset. Mistakenly, modifying multiple parameters at each iteration.

## [2.6.0] - 09/03/25
- Created `FORWARD_DATASET.run_forward` in `__forward.py`: for large datasets, loads only the k‑nearest samples to the target in parameter space (configurable via `interp_max_samples`, default 5000) before interpolating, reducing memory and CPU; uses Delaunay linear interpolation with nearest‑neighbor fallback. 
- `FORWARD_DATASET` can be used during the retrieval process to retrieve on a pre-computed dataset instead of calculating the spectrum on the fly using the standard `FORWARD_MOD`. It can also be used during when `create_spectrum` is invoked. Set `physics_model` equal to `dataset` and define `dataset_dir` with the dataset directory path in yhe parameter file to use this funcionality.
- Integrated dataset interpolation path across the pipeline: `forward()` and `MULTINEST` respect `param['physics_model'] == 'dataset'` and read from `param['dataset_dir']`.
- Added `__utils.adjust_ranges_from_dataset()` to auto-derive retrieval bounds from `dataset.csv` (validates columns, supports common aliases).
- Improved validation and error messages for dataset mode; clearer guidance when required files/keys are missing.
- Performance: nearest-neighbor presampling via `interp_max_samples` (2 ** dimension) reduces memory/CPU for large datasets.

## [2.5.5] - 09/01/25
- Centralized post‑processing in `__plotting.py`: `MULTINEST` now delegates spectrum, chemistry, surface‑albedo, and posterior plots to shared helpers, reducing duplication and improving maintainability.
- Added `plot_nest_spec`: overlays MAP model on data native and R=500 grids, optionally draws 1σ/2σ/3σ bands from `random_samples.dat`, and saves `Nest_spectrum.pdf` plus `Best_fit.dat` (per‑solution when multimodal).
- Unified posterior plotting via `plot_posteriors`: preserves filenames (`Nest_trace.png`, `Nest_posteriors.pdf`), supports multi‑mode runs, and converts gas parameters to VMR space when applicable.
- Light visual polish for plots (style, labels) and minor I/O reductions during post‑processing.
- Simplified `MULTINEST` post‑processing: removed embedded plotting methods and now invoke helpers from `__plotting` for chemistry and surface‑albedo figures.
- Refactored plotting to dedicated `__plotting.py` module: moved `plot_chemistry` and `plot_surface_albedo` out of `__multinest.py` and updated all references/calls.

## [2.5.4] - 08/31/25
- Strengthened dataset CSV validation in `GEN_DATASET`: compare exact header names against `['index'] + par` instead of only checking column count. Prevents appending to incompatible files and improves robustness.
- Added the possibility to generate more samples for an existing generated dataset.

## [2.5.3] - 08/31/25
- Developed the `CREATE_DATASET` module. ExoReL can now generate datasets by sampling multiple parameter ranges. `sobol` or `random` sequencing can be chosen. It supports MPI for parallel computing.
- Added fast CSV dataset export in `CREATE_DATASET`: writes `dataset.csv` with a leading `index` column and ordered parameter headers, plus `dataset_meta.json` sidecar with metadata. MPI-safe (writes on rank 0).
- Improved console mapping of sampled parameters to bounds in dataset generation.

## [2.5.2] - 08/30/25
- Added automatic download of required data folders (`forward_mod`, `PHO_STELLAR_MODEL`) on import when missing, using `gdown`; validates content and cleans temporary artifacts.
- Introduced public helper `ensure_required_data()` to trigger the data check/download explicitly.
- Refactored data download logic and improved error handling and user feedback with clearer messages.
- Updated `requirements.txt` to include optional `gdown` dependency for Google Drive downloads.

## [2.5.1] - 08/29/25
- Fixed verbosity of the model. When calling `CREATE_SPECTRUM` you can set verobose as bool variable.
- Minor bugfixes

## [2.5.0] - 08/15/25
- standard_parameters.dat has been retired. Now the module __utils.default_parameters() sets the standard parameters when ExoReL is imported.
- The Gas model and Rocky model have been unified.
- The folder `forward_gas_mod` has been deprecated. The folder `forward_rocky_mod` has been renamed to `forward_mod`.
- The `wl_bins` has been moved inside `./foward_mod/Data/`

## [2.4.2] - 04/14/25
- Added O2-O2 CIA.
- Added new plot for surface albedo. The plot is automatically generated if the parameter `surface_albedo_parameters` is greater than 1. This plot is generated in the retrieval post-processing by the function `plot_surface_albedo`.
- Fixed the bug that would stall the retrieval. The code was stuck in a while loop without possibility to exit it. Added a time limit of 10mins in that while. The bug is due to C code not completing the calculation.

## [2.4.1] - 04/09/25
- Plotting bugfix (the error still persists on the server. Check that the matplotlib version is up to date. It works on matplotlib version `3.8.4`).

## [2.4.0] - 04/01/25
- The surface albedo is now treated as an array in the code.
- Added the possibility to fit for a non gray surface albedo. The user can use the key `surface_albedo_parameters` and set it to 1, 3, or 5. Default is 1.
- Added a new module (`__surface_structure`) to the FORWARD_ROCKY_MODEL class to handle the new changes on the surface albedo.
- reintroduction of the `custom_spectral_binning` function for binning the spectrum.
- `custom_spectral_binning` will be used instead of the package spectres when the wavelength bins limits are explicitly used in the input spectrum file.

## [2.3.8] - 09/23/24
- Model errorbars can now be plotted in the `NEST_spectrum` plot. Errorbars will automatically plot only if the key `calc_likelihood_data` was set to True in the parameter file.
- The best fit model is now saved in a file (`Best_fit.dat`) together with 1, 2, and 3 sigmas confidence regions.
- Introduced the `spectres` python package that substitutes the `custom_spectral_binning` util function throughout the ExoReL.
- Change the prior function for the surface albedo from log-uniform to linear uniform.
- The post processing will not produce .png figures anymore.

## [2.3.7] - 07/30/24
- Introduced the `CREATE_DATASET` class. It leverages MPI to generate datasets of spectra.
- Including H2 as free parameters in the rocky model.
- Bugfixes (plotting posteriors, clear c files)

## [2.3.6] - 05/23/24
- The wavelength range of the C code is now dinamically calculated based on the input spectrum/file.
- Added possibility to generate a flat albedo spectrum. Use the parameters `flat_albedo` and `flat_albedo_value`.
- Added the possibility to calculate the likelihood per single datapoint in post processing. Enabled by the flag `calc_likelihood_data` (default is False), and moderated by the flag `n_likelihood_data` (default 10000) which specify how many single datapoint likelihood to calculate. This function is MPI compatible.
- Minor Bugfixes (p_size)

## [2.3.5] - 03/25/24
- Modified refractive index for N2 and O2.
- Possibility to choose to filter multiple MultiNest solutions or not. Use the `filter_multi_solutions` in the retrieval parameter file. Default: True.
- Possibility to re-adjust the VMR of the entire atmosphere or only the filled gas due to H2O absorption. Use `adjust_VMR_gases` in the parameter file Default: True (change all gases).
- Plotting bugfixes.

## [2.3.4] - 02/15/24
- Bugfixes:
    - Noise calculatiion when creating spectra. Only two modes are now available, 0 and 1. Mode 1 calculates the SNR per wavelength.
    - Plotting of retrieval process when `cld_frac` is fitted.

## [2.3.3] - 01/31/24
- Fixed the molecular contribution plot. Rayleigh is shown together with each single molecule weighted for the molecule`s VMR.
- Added the ability to fit for the cloud fraction, `fit_cld_frac` (default: False). When fit for cloud fraction the model will calculate two columns (double the calculation time) and average between the two columns. This effectively makes the code 1.5D.
- Added a new parameter, i.e. `cld_frac` (default: 1.0), to be used in the parameter file to generate spectra with variable cloud fraction.
- Remaining C files from previous run are now automatically cleaned before starting any new calculations.

## [2.3.2] - 01/24/24
- Low significance multiple solutions will be filtered out (based on the local log-evidence).
- Bugfixes.

## [2.3.1] - 12/20/23
- Rayleigh scattering is now consistently calculated with the actual simulated chemical composition.
- Loglikelihood traces as well as all the evaluations are exported and saved.
- Minor bugfixes.

## [2.3.0] - 12/07/23
- New standard parameter, i.e. `gas_par_space` (default: None), to chose in which space to fit the chemical composition of rocky planets.
- Introduced `partial_pressure` as parameter space for fitting the atmospheric chemical composition of rocky planets.
- Introduced `volume_mixing_ratio` and `vmr` as parameter space for fitting the atmospheric chemical composition of rocky planets.
- The volume mixing ratio of all the gasses is now adjusted when the VMR of H2O decrease due to clouds. NOTE - Does not work in case of NH3 clouds.
- `plot_chemistry` function moved from __utils.py to MULTINEST class.

## [2.2.5] - 11/27/23
- The `__utils.add_noise` function now returns the simulated data with the minimum chi-square (compared to the plain model) after 100 simulations of gaussian noise.
- For the rocky planet model:
    - Added CO and N2O as free parameters of the model. Added possibility to fit the VMR of these gasses.
    - Re-introduced the adaptive altitude grid.
    - Condensation Ratio (CR) retrieval range cropped between [-5.0, 0.0].
    - Surface pressure (P0) retrieval range cropped between [4.0, 7.0].
    - Water cloud top pressure (Pw_top) retrieval range cropped between [0.0, 7.0].
    - Water cloud depth (cldw_depth) retrieval range cropped between [0, 6.5].
    - Surface albedo (ag) retrieval range cropped between [0, 0.1].
    - Clouds are not allowed to touch the surface anymore. If this happens, no clouds will be included in the atmosphere.
    - `__utils.cloud_rocky_pos` fixed in case no_cloud are included in the model.
- `VIS140_NIR70` and `VIS500_NIR500` have been included as wavelength bin files. Can be used to generate spectra.
- Binning algorithm updated. Now the input file can contain `bin_low` and `bin_high` as first and second column for a more precise binning.
- Introduced scikit-bio (v0.5.9) package to calculate between gas volume-mixing-ratio and gas centered-log-ratio.
- Updated References list.
- Introducing debug mode.
- Dropped Python 2.x support.
